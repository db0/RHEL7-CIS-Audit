## metadata for Audit benchmark
benchmark_version: '3.1.1'

# Set if genuine RHEL (subscription manager check) not for derivatives e.g. CentOS
is_redhat_os: true

# timeout for each command to run where set - default = 10seconds/10000ms
timeout_ms: 30000

# Taken from LE rhel7-cis

rhel7cis_notauto: false
rhel7cis_section1: true
rhel7cis_section2: true
rhel7cis_section3: true
rhel7cis_section4: true
rhel7cis_section5: true
rhel7cis_section6: true

rhel7cis_selinux_disable: false
rhel7cis_selinux_state: enforcing

rhel7cis_level1: true
rhel7cis_level2: true
# to enable rules that may have IO impact on a system e.g. full filesystem scans or CPU heavy
run_heavy_tests: true

# if Bios boot
rhel7cis_legacy_boot: true
rhel7cis_bootloader_file: /boot/grub2/grub.cfg
rhel7cis_bootloader_user: /boot/grub2/user.cfg

#  if UEFI - note changes from redhat to centos depenadent on OS
#  rhel7cis_legacy_boot: false
#  rhel7cis_bootloader_file: /boot/efi/EFI/redhat/grub.cfg
#  rhel7cis_bootloader_user: /boot/efi/EFI/redhat/user.cfg

# These variables correspond with the CIS rule IDs or paragraph numbers defined in
# the CIS benchmark documents.
# PLEASE NOTE: These work in coordination with the section # group variables and tags.
# You must enable an entire section in order for the variables below to take effect.

# Section 1 rules
rhel7cis_rule_1_1_1_1: true
rhel7cis_rule_1_1_1_2: true
rhel7cis_rule_1_1_1_3: true
SEC_ID_CONFIGURE_TMP: true
SEC_ID_CONFIGURE_TMP_NODEV: true
SEC_ID_CONFIGURE_TMP_NOSUID: true
SEC_ID_CONFIGURE_TMP_NOEXEC: true
SEC_ID_CONFIGURE_SHM: true
SEC_ID_CONFIGURE_SHM_NODEV: true
SEC_ID_CONFIGURE_SHM_NOSUID: true
SEC_ID_CONFIGURE_SHM_NOEXEC: true
SEC_ID_SEPARATE_VAR: true
SEC_ID_SEPARATE_VAR_TMP: true
SEC_ID_CONFIGURE_VAR_TMP_NODEV: true
SEC_ID_CONFIGURE_VAR_TMP_NOSUID: true
SEC_ID_CONFIGURE_VAR_TMP_NOEXEC: true
SEC_ID_SEPARATE_VAR_LOG: true
SEC_ID_SEPARATE_VAR_LOG_AUDIT: true
SEC_ID_SEPARATE_HOME: true
SEC_ID_CONFIGURE_HOME_NODEV: true
SEC_ID_CONFIGURE_MEDIA_NODEV: true
SEC_ID_CONFIGURE_MEDIA_NOSUID: true
SEC_ID_CONFIGURE_MEDIA_NOEXEC: true
SEC_ID_WORLD_WRITABLE_STICKY_BIT: true
SEC_ID_DISABLE_AUTOMOUNT: true
SEC_ID_DISABLE_USB_STORAGE: true
SEC_ID_CONFIGURE_GPG_KEYS: true
SEC_ID_CONFIGURE_PACKAGE_MANAGER_REPOS: true
SEC_ID_ACTIVATE_GPG_GLOBALLY: true
SEC_ID_CONFIGURE_RHSM: true
SEC_ID_DISABLE_RHNSD: true
SEC_ID_AIDE_SETUP: true
SEC_ID_AIDE_SCHEDULE: true
SEC_ID_BOOT_PASSWORD: true
SEC_ID_BOOTLOADER_PERMS: true
SEC_ID_SINGLE_USER_AUTH_NEEDED: true
SEC_ID_ENSURE_CORE_DUMPS_ARE_RESTRICED: true
SEC_ID_ENSURE_NX_ND_SUPPORT_ENABLED: true
SEC_ID_ENSURE_ADDRESS_SPACE_RANDOMIZATION_ENABLED: true
SEC_ID_ENSURE_PRELINK_NOT_INSTALLED: true
SEC_ID_ENSURE_SELINUX_INSTALLED: true
SEC_ID_ENSURE_SELINUX_NOT_DISABLED_IN_BOOTLOADER: true
SEC_ID_ENSURE_SELINUX_POLICY_CONFIGURED: true
SEC_ID_ENSURE_SELINUX_MODE_ENFORCING_OR_PERMISSIVE: true
SEC_ID_ENSURE_SELINUX_MODE_ENFORCING: true
SEC_ID_ENSURE_NO_UNCONFINED_SERVICES_EXIST: true
SEC_ID_ENSURE_SETROUBLESHOOT_NOT_INSTALLED: true
SEC_ID_ENSURE_MCSTRANS_NOT_INSTALLED: true
SEC_ID_ENSURE_MOTD_CONFIGURED: true
SEC_ID_ENSURE_LOCAL_LOGIN_BANNER_CONFIGURED: true
SEC_ID_ENSURE_REMOTE_LOGIN_BANNER_CONFIGURED: true
SEC_ID_ENSURE_ETC_MOTD_PERMISSIONS_CONFIGURED: true
SEC_ID_ENSURE_ETC_ISSUE_PERMISSIONS_CONFIGURED: true
SEC_ID_ENSURE_ETC_ISSUE_NET_PERMISSIONS_CONFIGURED: true
SEC_ID_ENSURE_GDM_IS_REMOVED: true
SEC_ID_ENSURE_GDM_LOGIN_BANNER_CONFIGURED: true
SEC_ID_ENSURE_LAST_LOGGED_USER_DISPLAYED: true
SEC_ID_ENSURE_XDCMP_NOT_ENABLED: true
SEC_ID_UPDATES_AND_PATCHES: true

# section 2 rules
SEC_ID_ENSURE_XINETD_NOT_INSTALLED: true
SEC_ID_ENSURE_TIME_SYNCHRONIZATION_IN_USE: true
SEC_ID_ENSURE_CHRONY_CONFIGURED: true
SEC_ID_ENSURE_NTPD_CONFIGURED: true
SEC_ID_X11_COMPONENTS_NOT_INSTALLED: true
SEC_ID_AVAHI_SERVER_NOT_INSTALLED: true
SEC_ID_CUPS_SERVER_NOT_INSTALLED: true
SEC_ID_DHCP_SERVER_NOT_INSTALLED: true
SEC_ID_LDAP_SERVER_NOT_INSTALLED: true
SEC_ID_DNS_SERVER_NOT_INSTALLED: true
SEC_ID_FTP_SERVER_NOT_INSTALLED: true
SEC_ID_HTTP_SERVER_NOT_INSTALLED: true
SEC_ID_IMAP_POP3_SERVER_NOT_INSTALLED: true
SEC_ID_SAMBA_SERVER_NOT_INSTALLED: true
SEC_ID_HTTP_PROXY_SERVER_NOT_INSTALLED: true
SEC_ID_NET_SNMP_NOT_INSTALLED: true
SEC_ID_NIS_SERVER_NOT_INSTALLED: true
SEC_ID_TELNET_SERVER_NOT_INSTALLED: true
SEC_ID_MTA_CONFIGURED_LOCAL_ONLY: true
SEC_ID_NFS_UTILS_NOT_INSTALLED: true
SEC_ID_RPC_BIND_NOT_INSTALLED: true
SEC_ID_RSYNC_NOT_INSTALLED: true
SEC_ID_ENSURE_NIS_CLIENT_NOT_INSTALLED: true
SEC_ID_ENSURE_RSH_CLIENT_NOT_INSTALLED: true
SEC_ID_ENSURE_TALK_CLIENT_NOT_INSTALLED: true
SEC_ID_ENSURE_TELNET_CLIENT_NOT_INSTALLED: true
SEC_ID_ENSURE_LDAP_CLIENT_NOT_INSTALLED: true

# Section 3 rules
SEC_ID_DISABLE_IPV6: true
SEC_ID_ENSURE_WIRELESS_INTERFACE_DISABLED: true
SEC_ID_ENSURE_IP_FORWARDING_DISABLED: true
SEC_ID_ENSURE_PACKET_REDIRECT_DISABLED: true
SEC_ID_ENSURE_SOURCE_ROUTED_PACKETS_NOT_ACCEPTED: true
SEC_ID_ENSURE_ICMP_REDIRECTS_NOT_ACCEPTED: true
SEC_ID_ENSURE_SECURE_ICMP_REDIRECTS_NOT_ACCEPTED: true
SEC_ID_ENSURE_SUSPICIOUS_PACKETS_LOGGED: true
SEC_ID_ENSURE_BROADCAST_ICMP_REQUESTS_IGNORED: true
SEC_ID_ENSURE_BOGUS_ICMP_RESPONSES_IGNORED: true
SEC_ID_ENSURE_REVERSE_PATH_FILTERING_ENABLED: true
SEC_ID_ENSURE_TCP_SYN_COOKIES_ENABLED: true
SEC_ID_ENSURE_ROUTER_ADVERTISEMENTS_NOT_ACCEPTED: true
SEC_ID_ENSURE_DCCP_DISABLED: true
SEC_ID_ENSURE_SCTP_DISABLED: true
SEC_ID_ENSURE_FIREWALLD_INSTALLED: true
SEC_ID_ENSURE_IPTABLES_NOT_INSTALLED_WITH_FIREWALLD: true
SEC_ID_ENSURE_NFTABLES_DISABLED_WITH_FIREWALLD: true
SEC_ID_ENSURE_FIREWALLD_SERVICE_ENABLED: true
SEC_ID_ENSURE_FIREWALLD_DEFAULT_ZONE_NOT_SET: true
SEC_ID_ENSURE_NETWORK_INTERFACES_ASSIGNED_TO_APPROPRIATE_USE: true
SEC_ID_ENSURE_FIREWALLD_DROPS_UNNECESSARY_SERVICES_PORTS: true
SEC_ID_ENSURE_NFTABLES_INSTALLED: true
SEC_ID_ENSURE_FIREWALLD_NOT_INSTALLED_WITH_NFTABLES: true
SEC_ID_ENSURE_IPTABLES_NOT_INSTALLED_WITH_NFTABLES: true
SEC_ID_ENSURE_IPTABLES_ARE_FLUSHED_WITH_NFTABLES: false
SEC_ID_ENSURE_AN_NFTABLES_TABLE_EXISTS: false
SEC_ID_ENSURE_NFTABLES_BASE_CHAINS_EXISTS: false
SEC_ID_ENSURE_NFTABLES_LOOPBACK_TRAFFIC_CONFIGURED: false
SEC_ID_ENSURE_NFTABLES_OUTBOUND_AND_ESTABILISHED_CONNECTION_CONFIGURED: false
SEC_ID_ENSURE_NFTABLES_DEFAULT_DENY_FIREWALL_POLICY: false
SEC_ID_ENSURE_NFTABLES_SERVICE_ENABLED: true
SEC_ID_ENSURE_NFTABLES_RULES_PERMANENT: true
SEC_ID_ENSURE_IPTABLES_INSTALLED: true
SEC_ID_ENSURE_NFTABLES_NOT_INSTALLED_WITH_IPTABLES: true
SEC_ID_ENSURE_FIREWALLD_NOT_INSTALLED_WITH_IPTABLES: true

# Section 4 rules
SEC_ID_ENSURE_AUDITD_INSTALLED: true
SEC_ID_ENSURE_AUDITD_ENABLED: true
SEC_ID_ENSURE_AUDITING_FOR_PRE_AUDITD_SERVICES_ENABLED: true
SEC_ID_ENSURE_AUDIT_LOG_STORAGE_ENABLED: true
SEC_ID_ENSURE_AUDIT_LOGS_NOT_AUTOMATICALLY_DELETED: true
SEC_ID_ENSURE_SYSTEM_DISABLED_WHEN_AUDIT_FULL: true
SEC_ID_ENSURE_AUDIT_BACKLOG_LIMIT_SUFFICIENT: true
SEC_ID_ENSURE_DATE_TIME_EVENTS_COLLECTED: true
SEC_ID_ENSURE_USER_GROUP_EVENTS_COLLECTED: true
SEC_ID_ENSURE_NETWORK_ENVIRONMENT_EVENTS_COLLECTED: true
SEC_ID_ENSURE_MANDATORY_ACCESS_CONTROL_EVENTS_COLLECTED: true
SEC_ID_ENSURE_LOGIN_LOGOUT_EVENTS_COLLECTED: true
SEC_ID_ENSURE_SESSION_INIT_INFO_COLLECTED: true
SEC_ID_ENSURE_DISC_ACC_CTRL_PERM_COLLECTED: true
SEC_ID_ENSURE_UNAUTH_FILE_ACCESS_COLLECTED: true
SEC_ID_ENSURE_PRIV_COMMANDS_COLLECTED: true
SEC_ID_ENSURE_FS_MOUNTS_COLLECTED: true
SEC_ID_ENSURE_FILE_DELETION_EVENTS_COLLECTED: true
SEC_ID_ENSURE_SUDOERS_CHANGES_COLLECTED: true
SEC_ID_ENSURE_SUDO_COMMANDS_COLLECTED: true
SEC_ID_ENSURE_KERNEL_MODULE_ACTIONS_COLLECTED: true
SEC_ID_ENSURE_AUDIT_CONFIG_IMMUTABLE: true
SEC_ID_ENSURE_RSYSLOG_INSTALLED: true
SEC_ID_ENSURE_RSYSLOG_ENABLED: true
SEC_ID_ENSURE_DEFAULT_FILE_PERMS: true
SEC_ID_ENSURE_LOGGING_CONFIGURED: true
SEC_ID_ENSURE_RSYSLOG_REMOTE_LOGGING: true
SEC_ID_ENSURE_JOURNALD_TO_RSYSLOG: true
SEC_ID_ENSURE_JOURNALD_COMPRESSION: true
SEC_ID_ENSURE_WRITE_TO_PERSISTENT_DISK: true
SEC_ID_ENSURE_LOGFILE_PERMISSIONS: true

# Section 5
SEC_ID_ENSURE_CRON_ENABLED: true
SEC_ID_ENSURE_CRONTAB_PERMISSIONS: true
SEC_ID_ENSURE_CRON_HOURLY_PERMISSIONS: true
SEC_ID_ENSURE_CRON_DAILY_PERMISSIONS: true
SEC_ID_ENSURE_CRON_WEEKLY_PERMISSIONS: true
SEC_ID_ENSURE_CRON_MONTHLY_PERMISSIONS: true
SEC_ID_ENSURE_CRON_D_PERMISSIONS: true
SEC_ID_ENSURE_CRON_RESTRICTED: true
SEC_ID_ENSURE_AT_RESTRICTED: true
SEC_ID_ENSURE_SUDO_INSTALLED: true
SEC_ID_ENSURE_SUDO_PTY: true
SEC_ID_ENSURE_SUDO_LOG_EXISTS: true
SEC_ID_ENSURE_SSHD_PERMISSIONS: true
SEC_ID_ENSURE_SSH_PRIVATE_HOST_KEY_FILES: true
SEC_ID_ENSURE_SSH_PUBLIC_HOST_KEY_FILES: true
SEC_ID_ENSURE_SSH_ACCESS_LIMITED: true
SEC_ID_ENSURE_SSH_LOGLEVEL: true
SEC_ID_ENSURE_SSH_X11_FW_DISABLED: true
SEC_ID_ENSURE_SSH_MAXAUTHTRIES_LIMITED: true
SEC_ID_ENSURE_SSH_IGNORERHOSTS_ENABLED: true
SEC_ID_ENSURE_SSH_HOSTBASEDAUTHENTICATION_DISABLED: true
SEC_ID_ENSURE_SSH_ROOT_LOGIN_DISABLED: true
SEC_ID_ENSURE_SSH_EMPTY_PASSWORDS_DISABLED: true
SEC_ID_ENSURE_EMPTY_ENVIRONMENT_DISABLED: true
SEC_ID_ENSURE_STRONG_CIPHERS: true
SEC_ID_ENSURE_STRONG_MAC_ALGORITHMS: true
SEC_ID_ENSURE_STRONG_KEY_EXCHANGE_ALGORITHMS: true
SEC_ID_ENSURE_SSH_IDLE_TIMEOUT: true
SEC_ID_ENSURE_SSH_LOGINGRACETIME: true
SEC_ID_ENSURE_SSH_WARNING_BANNER: true
SEC_ID_ENSURE_SSH_PAM: true
SEC_ID_ENSURE_SSH_ALLOWTCPFORWARDING_DISABLED: true
SEC_ID_ENSURE_SSH_MAXSTARTUPS: true
SEC_ID_ENSURE_SSH_MAXSESSIONS_LIMITED: true
SEC_ID_ENSURE_PASSWORD_CREATION_REQS: true
SEC_ID_ENSURE_FAILED_ATTEMPTS_LOCKOUT: true
SEC_ID_ENSURE_PASSWORD_HASH_SHA512: true
SEC_ID_ENSURE_PASSWORD_REUSE_LIMITED: true
SEC_ID_ENSURE_PASSWORD_EXPIRY_365: true
SEC_ID_ENSURE_MINIMUM_DAYS_PASSWORD_CHANGE: true
SEC_ID_ENSURE_PASSWORD_EXPIRY_WARNING_7: true
SEC_ID_ENSURE_PASSWORD_LOCK_30: true
SEC_ID_ENSURE_PASSWORD_CHANGE_IN_PAST: true
rhel7cis_rule_5_5_2: true
rhel7cis_rule_5_5_3: true
rhel7cis_rule_5_5_4: true
rhel7cis_rule_5_5_5: true
rhel7cis_rule_5_7: true

# Section 6
rhel7cis_rule_6_1_1: true
rhel7cis_rule_6_1_2: true
rhel7cis_rule_6_1_3: true
rhel7cis_rule_6_1_4: true
rhel7cis_rule_6_1_5: true
rhel7cis_rule_6_1_6: true
rhel7cis_rule_6_1_7: true
rhel7cis_rule_6_1_8: true
rhel7cis_rule_6_1_9: true
rhel7cis_rule_6_1_10: true
rhel7cis_rule_6_1_11: true
rhel7cis_rule_6_1_12: true
rhel7cis_rule_6_1_13: true
rhel7cis_rule_6_1_14: true

rhel7cis_rule_6_2_1: true
rhel7cis_rule_6_2_2: true
rhel7cis_rule_6_2_3: true
rhel7cis_rule_6_2_4: true
rhel7cis_rule_6_2_5: true
rhel7cis_rule_6_2_6: true
rhel7cis_rule_6_2_7: true
rhel7cis_rule_6_2_8: true
rhel7cis_rule_6_2_9: true
rhel7cis_rule_6_2_10: true
rhel7cis_rule_6_2_11: true
rhel7cis_rule_6_2_12: true
rhel7cis_rule_6_2_13: true
rhel7cis_rule_6_2_14: true
rhel7cis_rule_6_2_15: true
rhel7cis_rule_6_2_16: true
rhel7cis_rule_6_2_17: true

# AIDE
rhel7cis_config_aide: true


# aide setup via - cron, timer
rhel7_aide_scan: cron
# AIDE cron settings
rhel7cis_aide_cron:
  cron_user: root
  cron_file: /etc/crontab
  aide_job: '/usr/sbin/aide --check'
  aide_minute: 0
  aide_hour: 5
  aide_day: '*'
  aide_month: '*'
  aide_weekday: '*'

# 1.5.1 Bootloader password
rhel7cis_bootloader_password: grub.pbkdf2.sha512.changethispart
rhel7cis_set_boot_pass: false

# Warning Banner Content (issue, issue.net, motd)
rhel7cis_warning_banner: Authorized uses only. All activity may be monitored and reported.
# End Banner

# Set to 'true' if X Windows is needed in your environment
rhel7cis_xwindows_required: false

# Whether or not to run tasks related to auditing/patching the desktop environment
rhel7cis_gui: false

# xinetd required
rhel7cis_xinetd_required: false

# IPv6 required
rhel7cis_ipv6_required: false

# System network parameters (host only OR host and router)
rhel7cis_is_router: false

# Time Synchronization
rhel7cis_time_synchronization: chrony
#  rhel7cis_time_synchronization: ntp

# Service configuration booleans set true to keep service
rhel7cis_avahi_server: false
rhel7cis_cups_server: false
rhel7cis_dhcp_server: false
rhel7cis_ldap_server: false
rhel7cis_telnet_server: false
rhel7cis_nfs_server: true
rhel7cis_rpc_server: true
rhel7cis_ntalk_server: false
rhel7cis_rsyncd_server: true
rhel7cis_tftp_server: false
rhel7cis_rsh_server: false
rhel7cis_nis_server: false
rhel7cis_snmp_server: false
rhel7cis_squid_server: false
rhel7cis_smb_server: false
rhel7cis_dovecot_server: false
rhel7cis_httpd_server: false
rhel7cis_vsftpd_server: false
rhel7cis_named_server: false
rhel7cis_nfs_rpc_server: false
rhel7cis_is_mail_server: false
rhel7cis_bind: false
rhel7cis_vsftpd: false
rhel7cis_httpd: false
rhel7cis_dovecot: false
rhel7cis_samba: false
rhel7cis_squid: false
rhel7cis_net_snmp: false
rhel7cis_allow_autofs: false

# client services
rhel7cis_openldap_clients_required: false
rhel7cis_telnet_required: false
rhel7cis_talk_required: false
rhel7cis_rsh_required: false
rhel7cis_ypbind_required: false

rhel7cis_firewall: firewalld
# rhel7cis_firewall: iptables
rhel7cis_default_firewall_zone: 'public'
rhel7cis_firewall_interface:
  - ['ens224']
  - ['ens192']
rhel7cis_firewall_services:
  - ssh
  - dhcpv6-client


### Section 4
## auditd settings
rhel7cis_auditd:
  space_left_action: email
  action_mail_acct: root
  admin_space_left_action: halt
  max_log_file_action: keep_logs
  auditd_backlog_limit: 8192

## syslog
rhel7cis_rsyslog: true

### Section 5
rhel7cis_sshd_limited: false
# Note the following to understand precedence and layout
rhel7cis_sshd_access:
  - AllowUser
  - AllowGroup
  - DenyUser
  - DenyGroup

rhel7cis_ssh_strong_ciphers: Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
rhel7cis_ssh_weak_ciphers:
  - 3des-cbc
  - aes128-cbc
  - aes192-cbc
  - aes256-cbc
  - arcfour
  - arcfour128
  - arcfour256
  - blowfish-cbc
  - cast128-cbc
  - rijndael-cbc@lysator.liu.se

rhel7cis_ssh_strong_macs: MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256
rhel7cis_ssh_weak_macs:
  - hmac-md5
  - hmac-md5-96
  - hmac-ripemd160
  - hmac-sha1
  - hmac-sha1-96
  - umac-64@openssh.com
  - umac-128@openssh.com
  - hmac-md5-etm@openssh.com
  - hmac-md5-96-etm@openssh.com
  - hmac-ripemd160-etm@openssh.com
  - hmac-sha1-etm@openssh.com
  - hmac-sha1-96-etm@openssh.com
  - umac-64-etm@openssh.com
  - umac-128-etm@openssh.com

rhel7cis_ssh_strong_kex: KexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256
rhel7cis_ssh_weak_kex:
  - diffie-hellman-group1-sha1
  - diffie-hellman-group14-sha1
  - diffie-hellman-group-exchange-sha1

rhel7cis_ssh_aliveinterval: "300"
rhel7cis_ssh_countmax: "3"

## PAM
rhel7cis_pam_password:
  - minclass = 4
rhel7cis_pam_passwd_retry: "3"
# faillock or tally2
rhel7cis_accountlock: faillock

## note this is to skip tests
skip_rhel7cis_pam_passwd_auth: true
skip_rhel7cis_pam_system_auth: true

# choose one of below
rhel7cis_pwhistory_so: "14"
rhel7cis_unix_so: false
rhel7cis_passwd_remember: "5"

# logins.def password settings
rhel7cis_pass_max_days: 365
rhel7cis_pass_min_days: 1
rhel7cis_pass_warn_age: 7

# set sugroup if differs from wheel
rhel7cis_sugroup: wheel

# sugroup users list
rhel7cis_sugroup_users: "root"
